<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>íŒ¨ë„ ê´€ë¦¬</title>
  <style>
    body{background:#0b0b0b;color:#fff;font-family:"Noto Sans KR",sans-serif;padding:22px}
    h1{margin:0 0 8px}
    .hint{opacity:.7;font-size:12px;margin-bottom:14px}
    .card{background:#111;border:1px solid rgba(255,255,255,.12);border-radius:14px;padding:14px;margin:12px 0}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin:10px 0}
    label{font-weight:900;opacity:.9}
    input[type="number"],input[type="range"]{accent-color:#1e7bff}
    input[type="number"]{width:90px;padding:8px 10px;border-radius:10px;border:1px solid rgba(255,255,255,.15);background:#121212;color:#fff}
    .btn{padding:10px 12px;border-radius:12px;border:none;font-weight:900;cursor:pointer}
    .primary{background:#1e7bff;color:#fff}
    .ghost{background:transparent;border:1px solid rgba(255,255,255,.15);color:#fff}
    .panel-title{font-size:14px;font-weight:900;margin-bottom:10px}
    .kv{opacity:.75;font-size:12px}
    .switch{display:flex;align-items:center;gap:8px}
    .slider{width:220px}
    #msg{margin-top:10px;opacity:.85}
  </style>
</head>
<body>

<h1>ğŸ§© íŒ¨ë„ ê´€ë¦¬</h1>
<div class="hint">jobs / ì¼ë³¸ë‚ ì”¨ / ì¸ì²œí„°ë¯¸ë„ íŒ¨ë„ì„ ê°œë³„ ON/OFF í•˜ê³  í¬ê¸°/íˆ¬ëª…ë„/í°íŠ¸ í¬ê¸°ë¥¼ ì €ì¥í•©ë‹ˆë‹¤.<br>
(ëª¨ë‘ ë‹¤ì‹œ í‘œì‹œ ë²„íŠ¼ì€ ë¹„í™œì„±í™”ëœ íŒ¨ë„ì„ ë‹¤ì‹œ ì¼­ë‹ˆë‹¤.)</div>

<div class="card">
  <div class="row">
    <button class="btn primary" onclick="save()">ì €ì¥</button>
    <button class="btn ghost" onclick="reload()">ìƒˆë¡œê³ ì¹¨</button>
    <button class="btn ghost" onclick="resetPanels()">ëª¨ë‘ ë‹¤ì‹œ í‘œì‹œ</button>
    <span class="kv" id="updated"></span>
  </div>
  <div id="msg">ë¡œë”©ì¤‘...</div>
</div>

<div class="card" id="p-jobsjp"></div>
<div class="card" id="p-jpwx"></div>
<div class="card" id="p-icn"></div>

<script>
let cfg = null;

function panelEditor(key, title){
  const p = cfg?.panels?.[key] || {};
  return `
    <div class="panel-title">${title}</div>

    <div class="row switch">
      <label>í‘œì‹œ</label>
      <input type="checkbox" id="${key}-enabled" ${p.enabled ? "checked":""}/>
      <span class="kv">${key}</span>
    </div>

    <div class="row">
      <label>ë„ˆë¹„(px)</label>
      <input type="number" id="${key}-width" min="240" max="520" value="${p.width ?? 360}">
      <span class="kv">240~520</span>
    </div>

    <div class="row">
      <label>íˆ¬ëª…ë„</label>
      <input class="slider" type="range" id="${key}-opacity" min="0.05" max="0.90" step="0.01" value="${p.opacity ?? 0.22}" oninput="document.getElementById('${key}-opacity-val').innerText=this.value">
      <span class="kv" id="${key}-opacity-val">${p.opacity ?? 0.22}</span>
    </div>

    <div class="row">
      <label>í°íŠ¸(px)</label>
      <input type="number" id="${key}-fontSize" min="10" max="20" value="${p.fontSize ?? 13}">
      <span class="kv">10~20</span>
    </div>
  `;
}

async function reload(){
  const r = await fetch("/api/panels");
  const j = await r.json();
  cfg = j.data;

  document.getElementById("updated").innerText = "ì—…ë°ì´íŠ¸: " + (cfg.updated || "-");
  document.getElementById("msg").innerText = "âœ… ë¡œë“œ ì™„ë£Œ";

  document.getElementById("p-jobsjp").innerHTML = panelEditor("jobsjp", "ğŸ‡¯ğŸ‡µ ì¼ë³¸ ì·¨ì—… íŒ¨ë„");
  document.getElementById("p-jpwx").innerHTML   = panelEditor("jpwx", "ğŸ‡¯ğŸ‡µ ì¼ë³¸ ë‚ ì”¨ íŒ¨ë„");
  document.getElementById("p-icn").innerHTML    = panelEditor("icn", "âœˆï¸ ì¸ì²œê³µí•­ í„°ë¯¸ë„ íŒ¨ë„");
}

function readPanel(key){
  return {
    enabled: document.getElementById(`${key}-enabled`).checked,
    width: Number(document.getElementById(`${key}-width`).value),
    opacity: Number(document.getElementById(`${key}-opacity`).value),
    fontSize: Number(document.getElementById(`${key}-fontSize`).value),
  };
}

async function save(){
  const body = { panels: {
    jobsjp: readPanel("jobsjp"),
    jpwx:   readPanel("jpwx"),
    icn:    readPanel("icn"),
  }};

  await fetch("/api/panels", {
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify(body)
  });

  document.getElementById("msg").innerText = "âœ… ì €ì¥ ì™„ë£Œ (ì˜¤ë²„ë ˆì´ 5ì´ˆ ë‚´ ë°˜ì˜)";
  reload();
}

async function resetPanels(){
  await fetch("/api/panels/reset", { method:"POST" });
  document.getElementById("msg").innerText = "âœ… ëª¨ë‘ ë‹¤ì‹œ í‘œì‹œ ìš”ì²­ ì™„ë£Œ (ì˜¤ë²„ë ˆì´ 5ì´ˆ ë‚´ ë°˜ì˜)";
  // ì„œë²„ì—ì„œ enabled ìƒíƒœë„ ì´ˆê¸°í™”ë˜ë¯€ë¡œ ì„¤ì •ì„ ë‹¤ì‹œ ë¶ˆëŸ¬ì™€ ë°˜ì˜
  reload();
}

reload();
</script>
</body>
</html>
